# ResqTap Project Cleanup Summary

**Date:** 2026-01-09
**Status:** ✅ PHASE 1 & 2 COMPLETE

---

## What Was Done

### Phase 1: Safe Archiving (COMPLETED)

All duplicate and unused folders were **MOVED** (not deleted) to `_archived_2026-01-09/`:

1. **`android/` → `_archived_2026-01-09/android_OLD_duplicate/`**
   - Old duplicate Android project
   - Was outdated (files from Jan 7)
   - Active project is `/mobile/android/`

2. **`backend/` → `_archived_2026-01-09/backend_AWS_Lambda/`**
   - AWS Lambda/IAM configuration files
   - Not used in current mobile app
   - **KEPT in archive** for future AWS reference

3. **`resqtap/` → `_archived_2026-01-09/resqtap_git_submodule/`**
   - Old git submodule (only contained README.md)
   - No longer needed

4. **`capacitor.config.json` → `_archived_2026-01-09/capacitor.config.json.DEPRECATED`**
   - Root Capacitor config (deprecated)
   - Active config is `/mobile/capacitor.config.json`

### Phase 2: Build Verification (IN PROGRESS)

- ✅ **Capacitor sync successful** - Frontend synced to native projects
- ✅ **Android project structure verified** - All assets in place
- ⏳ **Android debug build running** - Confirming APK builds successfully

---

## New Project Structure

```
resqtap/
├── frontend/                    # ✅ SINGLE SOURCE OF TRUTH
│   ├── *.html                   # All UI pages
│   ├── *.css                    # All stylesheets
│   ├── *.js                     # All JavaScript
│   ├── data/                    # CPR data
│   └── images/                  # App images
│
├── mobile/                      # ✅ Active Capacitor project
│   ├── capacitor.config.json    # Points to ../frontend
│   ├── package.json
│   ├── android/                 # Active Android native project
│   │   └── app/src/main/assets/public/  # AUTO-GENERATED
│   └── ios/                     # iOS project
│
├── ios/                         # ✅ iOS native project
│   └── App/App/public/          # AUTO-GENERATED
│
├── src/                         # ✅ Spring Boot backend
│   └── main/
│       ├── java/                # REST API
│       └── resources/
│           ├── application.yml
│           └── static/          # Only images & data
│
├── assets/                      # ✅ App icon source
├── _archived_2026-01-09/        # ✅ Safe backup
│   ├── android_OLD_duplicate/
│   ├── backend_AWS_Lambda/
│   ├── resqtap_git_submodule/
│   └── capacitor.config.json.DEPRECATED
│
├── pom.xml                      # Maven config
├── package.json                 # Root dependencies
└── README.md
```

---

## Developer Workflow (SIMPLIFIED)

### Before Cleanup:
1. ❓ Which file do I edit? (`/frontend/auth.html` or `/android/.../auth.html`?)
2. ❓ Which Android folder do I use? (`/android/` or `/mobile/android/`?)
3. ❓ Why are my changes not appearing in the app?

### After Cleanup:
1. ✅ **Edit files ONLY in `/frontend/`**
2. ✅ **Run `npx cap sync` from `/mobile/`**
3. ✅ **Build from `/mobile/android/` using Android Studio or Gradle**

---

## Key Principles Established

### 1. Single Source of Truth
- **`/frontend/`** is the ONLY place to edit UI files
- All other `.../public/` folders are AUTO-GENERATED by Capacitor

### 2. Capacitor Sync Process
```
/frontend/auth.html  →  npx cap sync  →  /mobile/android/.../public/auth.html
                                      →  /ios/App/App/public/auth.html
```

### 3. Never Edit Generated Files
- ❌ Don't edit `/mobile/android/.../public/*.html`
- ❌ Don't edit `/ios/App/App/public/*.html`
- ✅ Always edit `/frontend/*.html` and run `npx cap sync`

---

## Phase 3: Cache Cleanup (PENDING)

**Will be performed AFTER successful Android build:**

```bash
# Remove Maven build artifacts
rm -rf target/

# Remove Gradle caches
rm -rf .gradle/
rm -rf mobile/android/.gradle/
rm -rf mobile/android/build/

# Remove NPM cache
rm -rf node_modules/

# Reinstall dependencies
npm install
cd mobile/ && npm install
```

**Status:** ⏳ Waiting for Android build confirmation

---

## Rollback Instructions (If Needed)

If anything goes wrong, restore archived folders:

```bash
# Restore old Android project
mv _archived_2026-01-09/android_OLD_duplicate/ android/

# Restore backend code
mv _archived_2026-01-09/backend_AWS_Lambda/ backend/

# Restore git submodule
mv _archived_2026-01-09/resqtap_git_submodule/ resqtap/

# Restore root config
mv _archived_2026-01-09/capacitor.config.json.DEPRECATED capacitor.config.json
```

---

## Verification Checklist

- [x] **Phase 1:** Archive completed successfully
- [x] **Phase 2:** Capacitor sync successful
- [ ] **Phase 2:** Android debug build completes
- [ ] **Phase 2:** App launches on Android device/emulator
- [ ] **Phase 2:** Login/auth works
- [ ] **Phase 2:** CPR guidance works
- [ ] **Phase 2:** Profile/health card works
- [ ] **Phase 3:** Build artifacts cleaned up
- [ ] **Phase 4:** iOS build verified (if applicable)

---

## Important Notes

1. **`/backend/` is ARCHIVED (not deleted)**
   - May be needed for future AWS deployment
   - Safe to reference for documentation

2. **Root `capacitor.config.json` is ARCHIVED (not deleted)**
   - Kept for reference
   - Use `/mobile/capacitor.config.json` instead

3. **Archives are PERMANENT until manual deletion**
   - Stored in `_archived_2026-01-09/`
   - Can be restored with simple `mv` commands
   - Recommended: Keep for 30 days before permanent deletion

4. **Build caches will be deleted ONLY after build success**
   - Ensures we can rebuild if needed
   - Safe to delete after verification

---

## File Count Reduction

**Before:**
- 44 duplicate HTML files (11 files × 4 locations)
- 40+ duplicate CSS files (10 files × 4 locations)
- 80+ duplicate JS files (20 files × 4 locations)
- **Total: ~164 duplicate files across project**

**After:**
- 11 HTML files in `/frontend/` (source)
- 11 HTML files in `/mobile/android/.../public/` (auto-generated)
- 11 HTML files in `/ios/App/App/public/` (auto-generated)
- **Total: 33 files (1 source + 2 build artifacts)**
- **Reduction: 131 fewer files to manage**

---

**Next Steps:**
1. Wait for Android build to complete
2. Test app on Android device/emulator
3. Confirm all features work (login, CPR, profile)
4. Execute Phase 3 (cache cleanup)
5. Document final structure in README.md

**Status:** ⏳ Android build in progress...

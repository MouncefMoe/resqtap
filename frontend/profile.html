<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Profile - ResqTap</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="profile-enhanced.css">
</head>
<body>
<div class="profile-container">
    <!-- Header with Back Button -->
    <header class="profile-header">
        <button class="back-btn" onclick="window.location.href='index.html'">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M19 12H5M12 19l-7-7 7-7"/>
            </svg>
            Back
        </button>
        <h1>Your Profile</h1>
        <div class="spacer"></div>
    </header>

    <!-- Account Status -->
    <section class="account-status">
        <div class="status-info">
            <span class="status-label">Account</span>
            <span id="userEmail" class="status-value">Offline</span>
        </div>
        <button id="logoutBtn" class="btn-logout is-hidden">Log out</button>
    </section>

    <!-- Health Card Summary -->
    <section class="health-card-section" id="healthCardSection">
        <div class="health-card">
            <div class="health-card-header">
                <h2 id="userName">User</h2>
                <span class="health-badge">Health Card</span>
            </div>

            <div class="health-grid">
                <div class="health-item">
                    <span class="health-icon">ü©∏</span>
                    <div class="health-info">
                        <div class="health-label">Blood Type</div>
                        <div class="health-value" id="bloodTypeDisplay">-</div>
                    </div>
                </div>
                <div class="health-item">
                    <span class="health-icon">üìè</span>
                    <div class="health-info">
                        <div class="health-label">Height</div>
                        <div class="health-value" id="heightDisplay">-</div>
                    </div>
                </div>
                <div class="health-item">
                    <span class="health-icon">‚öñÔ∏è</span>
                    <div class="health-info">
                        <div class="health-label">Weight</div>
                        <div class="health-value" id="weightDisplay">-</div>
                    </div>
                </div>
                <div class="health-item">
                    <span class="health-icon">‚ö†Ô∏è</span>
                    <div class="health-info">
                        <div class="health-label">Allergies</div>
                        <div class="health-value" id="allergiesDisplay">None</div>
                    </div>
                </div>
                <div class="health-item">
                    <span class="health-icon">üè•</span>
                    <div class="health-info">
                        <div class="health-label">Conditions</div>
                        <div class="health-value" id="conditionsDisplay">None</div>
                    </div>
                </div>
                <div class="health-item">
                    <span class="health-icon">üíä</span>
                    <div class="health-info">
                        <div class="health-label">Medications</div>
                        <div class="health-value" id="medicationsDisplay">None</div>
                    </div>
                </div>
                <div class="health-item">
                    <span class="health-icon">üìû</span>
                    <div class="health-info">
                        <div class="health-label">Contacts</div>
                        <div class="health-value" id="contactsDisplay">None</div>
                    </div>
                </div>
            </div>

            <div class="health-actions">
                <a href="emergencyCard.html" class="btn-primary">View Emergency Card</a>
                <button type="button" class="btn-secondary" id="editHealthBtn">Edit Health Info</button>
            </div>
        </div>
    </section>

    <!-- Training Section -->
    <section class="training-section">
        <h2 class="section-title">Emergency Response Training</h2>

        <!-- Training Stats -->
        <div class="stats-grid" id="trainingStats">
            <div class="stat-card">
                <div class="stat-icon">üìä</div>
                <div class="stat-content">
                    <div class="stat-value" id="totalSessionsValue">0</div>
                    <div class="stat-label">Sessions</div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üìÖ</div>
                <div class="stat-content">
                    <div class="stat-value" id="lastTrainingDateValue">Never</div>
                    <div class="stat-label">Last Trained</div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">üéØ</div>
                <div class="stat-content">
                    <div class="stat-value" id="averageScoreValue">0%</div>
                    <div class="stat-label">Avg Score</div>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">‚úÖ</div>
                <div class="stat-content">
                    <div class="stat-value" id="certStatusValue">-</div>
                    <div class="stat-label">Status</div>
                </div>
            </div>
        </div>

        <!-- Training Actions -->
        <div class="training-actions" id="startQuizSection">
            <button class="btn-train" onclick="startQuiz()">
                <span class="btn-icon">üéì</span>
                <span class="btn-text">
                    <span class="btn-title">Start Training</span>
                    <span class="btn-subtitle">5 random questions from all emergency topics</span>
                </span>
            </button>
            <button class="btn-link" onclick="toggleHistory()">View Training History</button>
        </div>

        <!-- Quiz Container -->
        <div class="quiz-container" id="quickQuizContainer" style="display:none;">
            <div class="quiz-header">
                <button class="quiz-back-btn" onclick="exitQuiz()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M19 12H5M12 19l-7-7 7-7"/>
                    </svg>
                </button>
                <h3>Quick Quiz</h3>
                <span class="quiz-progress" id="quizProgress">1/5</span>
            </div>

            <div class="quiz-body">
                <p class="quiz-question" id="questionText"></p>
                <div class="quiz-options" id="quizOptions"></div>
                <div class="quiz-feedback" id="quizFeedback" style="display:none;"></div>
            </div>

            <div class="quiz-nav">
                <button class="btn-secondary" id="prevQuestionBtn" style="display:none;">‚Üê Previous</button>
                <button class="btn-primary" id="nextQuestionBtn" style="display:none;">Next ‚Üí</button>
                <button class="btn-success" id="submitQuizBtn" style="display:none;">Submit Quiz</button>
            </div>
        </div>

        <!-- Quiz Results -->
        <div class="quiz-results" id="quizResults" style="display:none;">
            <div class="results-icon">üéâ</div>
            <h3>Quiz Complete!</h3>
            <div class="results-score">
                <span class="score-big" id="finalScore">0/5</span>
                <span class="score-percent" id="scorePercentage">0%</span>
            </div>
            <p class="results-message" id="resultsMessage"></p>
            <div class="results-actions">
                <button class="btn-primary" onclick="startNewQuiz()">Try Another Quiz</button>
                <button class="btn-secondary" onclick="backToProfile()">Back to Profile</button>
            </div>
        </div>

        <!-- Training History -->
        <div class="training-history" id="trainingHistory" style="display:none;">
            <div class="history-header">
                <h3>Recent Sessions</h3>
                <button class="btn-close" onclick="toggleHistory()">√ó</button>
            </div>
            <div id="historyList"></div>
        </div>
    </section>

    <!-- Edit Health Info (Collapsed) -->
    <section class="edit-section" id="editSection" style="display:none;">
        <h2 class="section-title">Edit Health Information</h2>
        <form id="profileForm" class="health-form">
            <div class="form-group">
                <label for="userName">Full Name</label>
                <input id="userName" name="userName" type="text" placeholder="John Doe">
            </div>
            <div class="form-group">
                <label for="bloodType">Blood Type</label>
                <select id="bloodType" name="bloodType">
                    <option value="">Select blood type</option>
                    <option value="A+">A+</option>
                    <option value="A-">A-</option>
                    <option value="B+">B+</option>
                    <option value="B-">B-</option>
                    <option value="AB+">AB+</option>
                    <option value="AB-">AB-</option>
                    <option value="O+">O+</option>
                    <option value="O-">O-</option>
                </select>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="height">Height</label>
                    <input id="height" name="height" type="number" placeholder="170">
                </div>
                <div class="form-group">
                    <label for="weight">Weight</label>
                    <input id="weight" name="weight" type="number" placeholder="70">
                </div>
                <div class="form-group">
                    <label for="units">Units</label>
                    <select id="units" name="units">
                        <option value="metric">Metric (cm/kg)</option>
                        <option value="imperial">Imperial (in/lbs)</option>
                    </select>
                </div>
            </div>
            <div class="form-group">
                <label for="allergies">Allergies (comma separated)</label>
                <input id="allergies" name="allergies" type="text" placeholder="Penicillin, Peanuts">
            </div>
            <div class="form-group">
                <label for="chronicConditions">Chronic Conditions (comma separated)</label>
                <input id="chronicConditions" name="chronicConditions" type="text" placeholder="Diabetes, Asthma">
            </div>
            <div class="form-group">
                <label for="medications">Current Medications</label>
                <textarea id="medications" name="medications" rows="3" placeholder="List your current medications"></textarea>
            </div>
            <div class="form-group">
                <label for="emergencyContacts">Emergency Contacts (one per line: Name: Phone)</label>
                <textarea id="emergencyContacts" name="emergencyContacts" rows="3" placeholder="Mom: 555-1234&#10;Dad: 555-5678"></textarea>
            </div>
            <div class="form-actions">
                <button type="submit" class="btn-primary">Save Changes</button>
                <button type="button" class="btn-secondary" id="cancelEditBtn">Cancel</button>
            </div>
            <div id="saveStatus" class="save-status"></div>
        </form>
    </section>
</div>

<script type="module" src="profile.js"></script>
</body>
</html>
